# <span style="color: #ce1403; font-weight: Bold">Django</span>

### <span style="color: #ebce14;">A simple Django project</span>

- A full-featured web application by Django

## <span style="color: #44cecc;">Tutorial's Notes</span>

### <span style="color: #03ce14;">Getting started</span>

- <span style="color: Red;">Installation Instruction</span>
  - Install python
  - install pip
  - install git
  - Add git directory to windows environment variables path
  - ![](NoteImages/1.png)
  - Create repository on GitHub (django_project)
  - Edit README.md file
  - Create ssh key by using 'ssh-keygen' on cmd or terminal
  - Open ssh-key file and copy code
  - Create a new ssh key on GitHub
  - Add Tutor as collaborator on project
  - install Django using pip
  - Check django-admin
  - Start a new project by django-admin-> 'django-admin startproject django-project'
  - change the project name temporary
  - Download project from GitHub-> 'git clone ...'
  - Copy all file from django directory to cloned directory
  - Run server for the first time
  - Open project directory in vscode and run server again (localhost ip address)
  - Adjust .gitignor file
  - Edit git config and create first git commit and push to server
  - Now Everything is OK
- <span style="color: Red;">Django</span>
  - Django is a back-end server side web framework.
  - Other backend frameworks like flask, pyramid, ...
  - Django is free, open source and written in Python.
  - Django makes it easier to build web pages using Python.
  - <span style="color: #00dd99;">Django emphasizes **reusability** of components, also referred to as **DRY** (Don't Repeat Yourself), and comes with **ready-to-use** features like login system, database connection and CRUD operations (Create Read Update Delete).</span>
  - Django is especially helpful for database driven websites
- <span style="color: Red;">How does Django Work?</span>
  - Django follows the <span style="color: Red;">MVT</span> design pattern (Model View Template).
  - ![](NoteImages/2.png)
  - Model - The data you want to present, usually data from a database. <span style="color: Red;">model.py</span>
  - View - A request handler that returns the relevant template and content - based on the request from the user. <span style="color: Red;">view.py</span>
  - Template - A text file (like an HTML file) containing the layout of the web page, with logic on how to display the data. <span style="color: Red;">templates</span>
  - URL - Django also provides a way to navigate around the different pages in a website <span style="color: Red;">urls.py</span>
- <span style="color: Red;">So, What is Going On?</span>
  <ol>
  <li>Django receives the URL, checks the urls.py file, and calls the view that matches the URL.</li>
  <li>The view, located in views.py, checks for relevant models.</li>
  <li>The models are imported from the models.py file.</li>
  <li>The view then sends the data to a specified template in the template folder.</li>
  <li>The template contains HTML and Django tags, and with the data it returns finished HTML content back to the browser.</li></ol>
- <span style="color: Red;">Default Files</span>
  - <span style="color: Red;">manage.py</span> : Our main file that start pur application
  - The inner directory is core of our project
  - <span style="color: Red;">**init**.py</span> : make a python package
  - <span style="color: Red;">settings.py</span> : where are we able to change some project settings
  - <span style="color: Red;">urls.py</span> : where are we set our mapping system
  - <span style="color: Red;">wsgi.py</span> : (django web server)Where are our django project library settings and we never touch it.
  - check admin page to show urls.py functionality
- <span style="color: Red;">Create App</span>
  - An app is a web application that has a specific meaning in your project, like a home page, a contact form, or a members database.
  - ![](NoteImages/3.png)
  - We create an app using this command : <span style="color: orange;">"python manage.py startapp -app name- "
  - This command create a directory that contain necessary files for our blog
- <span style="color: Red;">Views</span>
  - Django views are Python functions that takes http requests and returns http response, like HTML documents.
  - A web page that uses Django is full of views with different tasks and missions.
  - We should create a view function in view.py file name <span style="color: Red;">'home'</span>
- <span style="color: Red;">Urls.py</span>
  - Create a file named <span style="color: Red;">urls.py</span> in the same folder as the views.py file
  - The urls.py file you just created is specific for the blog application
  - To use that we should copy <span style="color: blue;">path</span> import from project <span style="color: Red;">urls.py</span> file to our app <span style="color: Red;">urls.py</span> file and <span style="color: orange;">urlpatterns</span>
  - After that we should import our project view to urls.py(app) and create a route for our app home page.
  - Then we include our app <span style="color: orange;">urls.py</span> to project <span style="color: orange;">urls.py</span>
  - Django when check a patter and find one match and chops our url and send not matches part with request.
  - Run server again and check url patterns separately and check sources
  - Outline : user-url -> project-urls -> blog(app)-urls -> an empty string has been sended -> views.py -> home function -> its return a HttpResponse
  - Do same process for about page
  - Check url by changing in urls.py(pro) and check patterns blog -> blog_app
  - After change <span style="color: orange;">'blog/'</span> our project urls to <span style="color: orange;">' '</span> , our Project home page change to blog home page.
- <span style="color: Red;">Templates</span>
  - To return more complex html file we should create templates starting by create templates folder inside our blog app
  - We can't embed all html code inside **HttpRequest** method
  - Based of the Django Conventions we should create a folder inside templates folder named blog(our app name)
  - After that we should add our template files and name those based on our routes that has existed in views.py file
  - Add some Basic html code inside them
  - Now we need to add our blog application <span style="color: orange;">(in app.py)</span> to the list of our installed app <span style="color: Orange;">(in project settings.py)</span> to Django search for templates directory
  - ![](NoteImages/4.png)
  - After register our app by adding it in the project, Django search for templates, models, or anything related to our blog app inside blog directory
  - New we should define how to our route function load their specific template (also we can load and the return http request)
  - ![](NoteImages/5.png)
  - Do all things for about page as well.
- <span style="color: Red;">Passing data to Templates</span>
  - We can pass data by creating fake data and send the in dictionary form to template as third argument for render method
  - Django making template engine is something like Jinja2 that lets us to write python code inside html document
  - For writing a code block inside html doc we should use this pattern : <span style="color: Orange;">{% Our python code %}</span>
  - For accessing a variable inside html doc we should use this pattern : <span style="color: Orange;">{{ Our python variable }}</span>
  - In vscode by converting language mode to Django template helps us to write Django code easily
  - we can embed a python code (if statement) to manage our home page <span style="color: Red;">title</span>
- <span style="color: Red;">Template Inheritance</span>
  - To escape of writing duplicated code for all templates we can use template inheritance to make it easy to change common elements of all templates
  - We can do it by defining a <span style="color: Green;">base.html</span> file and make it a parent class for all other templates
  - We can import a <span style="color: Green;">block content</span> to our base.html to make a section that our child template can overwrite
  - Then we need to remove all information that is in our base.html from other templates
  - After that we need to extend the base.html codes to other templates by adding <span style="color: Red;">extend block</span> to them and a <span style="color: Red;">content block</span>
- <span style="color: Red;">Bootstrap</span>
  - We use Bootstrap to add some nice style to our website
  - Bootstrap is <span style="color: Pink;">Frontend framework</span> and we need to pass a crash course trough the internet to work with
  - By adding Bootstrap <span style="color: Red;">meta links</span> and <span style="color: Red;">javascript links</span>, we can use this libraries through the <span style="color: Red;">Content Delivery Network (CDN)</span> ability.
  - Template inheritance helps us to use bootstrap in all pages in our website
  - We need to copy Bootstrap <span style="color: Yellow;">starter meta codes</span> inside the head section of base.html file and bootstrap <span style="color: Yellow;">starter javascript code</span> at the end of this file before closing body tag
  - After that we need to warp our content block inside a <span style="color: Red;">div</span> that uses <span style="color: Yellow;">container</span> class
  - Check page source to show HTML code
  - Then we need to add some HTML code to our base.html file to make it stylish <span style="color: Red;">(header and main section)</span>
  - Then we need some custom style base on our bootstrap specific
  - We should create <span style="color: Red;">main.css</span> file inside <span style="color: Yellow;">Static /blog</span> directory in our <span style="color: Red;">app</span>
  - After copy all css codes inside main.css we need to include that into our base template by referencing it and <span style="color: Red;">load static code block</span >
  - And after that we need to create link to our static file inside head tag
  - After that we should put our article code to a specific blog so we put it in for loop of blog post in home template
  - At the end for separating our blog home of other apps home we should define url pattern in href of navigation bar to avoid hard coding(and explain name tag in url pattern)
- <span style="color: Red;">Admin Page</span>
  - Before migration creating a super user and entering to admin page is impossible
  - Explain the red error that shows after running server
  - First we should use <span style="color: Red;">makemigrations</span> command following <span style="color: Yellow;">'python manage.py'</span>
  - Second we should use <span style="color: Red;">migrate</span> command to create all essential and initial tables inside the database that have been created inside the default Django Database
  - After that we can create our super user and log in as admin inside Django admin page
  - In groups sections we can manage our admin users group
  - In user section we can see all admin user of our site
  - We can add a new user for test
- <span style="color: Red;">Database</span>
  - Django has its own <span style="color: Red;">ORM (Object Relational Mapper)</span> And its make it easy to access to our date base and easy to use it in Object Oriented way
  - Its allows us to use different databases without changing our code
  - We can represent our database structures as classes and we call that classes, <span style="color: Red;">Models</span>
  - We define our models inside <span style="color: Red;">models.py</span> file in our blog app
  - Django has its built-in user authentication system and we don't need to define user model
  - We can create all fields that we need for our entity inside of our database inside a model class
  - Model classes inherit from models class in Django
  - Actually we define all fields of our table using methods of models class
  - <span style="color: Red;">Max_length</span> define the maximum number of characters that our field can have
  - We use <span style="color: Red;">timezone</span> utility to be able to edit our DateTime field later
  - We create a <span style="color: Red;">foreign key</span> for user field and make relationship between our Post table and User table
  - We use <span style="color: Red;">on_delete</span> option to tell Django what happen to this posts, when the user who create this post gets deleted
  - By using <span style="color: Red;">makemigrations</span> command, we apply all our changes to the database
  - We can find migrations files inside migrations directory inside our blog app
  - We can check all sql statement that Django used to build up our table inside database, by using this command: <span style="color: Red;">python manage.py sqlmigrate blog -migration name-</span> without postfix
  - We can check and update our database using <span style="color: Orange;">shell</span> command following python manage.py
  - Migration allows us to update our database after creation or put data in it
  - Inside the shell environment we should import our User and Post models first (from blog.models import ...)
  - <span style="color: Red;">"from django.contrib.auth.models import User"</span>
  - We can check all objects in User table by this command: <span style="color: Red;">User.objects.all()</span> or User.objects.first() or last() (for the last one)
  - Also we can use filter() method base on the fields like user name
  - <span style="color: Yellow;">User.objects.filter(username='testuser')</span> / .first()
  - We can save queries in a variable and use it for checking its attributes
  - We can get a user by its id : <span style="color: Yellow;">User.objects.get(id=1)</span>
  - To create a post we can use <span style="color: Yellow;">post_1 = Post(...)</span> command and <span style="color: Yellow;">save</span> it finally
  - In order to help our post model present itself better, we can add a magic method to our post model using dander sign
  - To apply all changes and create backup we should exit shell and run it again
  - Notice, after rerun shell we should create our user again
  - After create two post we can save a post in a variable and show its attributes like **date_posted** / even user email (Its happened because foreign_key feature)
  - Django has a feature that helps us to easily access to all posts of a user. <span style="color: Red;">\_set.all()</span>
  - By using this feature we can create a new post for a specific user easily <span style="color: Red;">\_set.create(...)</span> / without specifying author
  - Now we can use our database information instead of dumpy data by importing Post from models and send info to home.html
  - We can use vertical bar to filter our date to a desirable form |date:"F d, Y"
  - We can add our new post model to Django gui interface by register it in <span style="color: Red;">admin.py</span> file, using this code: <span style="color: Red;">admin.site.register(Post)</span>
- <span style="color: Red;">User Registration</span>
  - First of all we create a new app for our site users
  - Register New app in django project settings
  - Create view for our users app registration page
  - Django make it easy to create a validation or insert value form. (Django Built it automatically)
  - First we should create and register a new app (users)
  - Then we should create a view for our registration page (using built-in features of THe Django)
  - After that we need to create a template for our registration page inside the new app folder base on Django conventions
  - We should extend our base.html templates there and get some nice style to it
  - We should add a <span style="color: Red;">csrf_token (Cross Site Request Forgery)</span> to our form to protect it from some kind of attacks
  - Explain some Bootstrap css classes like <span style="color: Red;">mb-4</span> or <span style="color: Red;">pt-2</span>
  - Now we need to make a url pattern for this registration page
  - We should import our users app views to our project urlpattern file and check it by running server.
  - To make it better in style we should run our form elements as paragraph tag by using <span style="color: Red;">as_p</span> at end of our form name
  - After that we should talk about HTTP methods and manage our form <span style="color: Red;">POST</span> requests
  - Then we need to define variables to get form data clearly and show <span style="color: Red;">flash message(One time alert message)</span> by import <span style="color: Red;">messages</span> from Django. Here is the some of flash messages:
    - messages.debug
    - messages.info
    - messages.success
    - messages.warning
    - messages.error
  - After that we should redirect user to home page by importing <span style="color: Red;">redirect</span> method
  - Before check the flash message we need to define it in our base.html file
  - We should get message there and show it to user by Django For And if statements and Bootstrap
  - By using <span style="color: Red;">save()</span> method we can save our new user
  - To customize our user registration form we should built a new file in our user app root directory named <span style="color: Red;">forms.py</span> to make our desire form
  - <span style="color: Red;">Meta class</span> actually gives us a nested namespace or configurations that says what model that would be effected and define which model would be effected and in what order
  - To get a good and suitable shape to our form we use a third-party app name <span style="color: Red;">django-crispy-forms and django-crispy-bootstrap5</span> (first we should install it using pipenv) - after install we should register both of them in the Django settings file
  - In register template we nee to load <span style="color: Red;">crispy_forms_tags</span>
  - In page **source** we can check all bootstrap
- <span style="color: Red;">Login and Logout System</span>
  - Django provide views for us to handel Log in and Log out process
  - We should import Django auth views for Login and Logout in project urls.py file
  - Before add template name to as_view() method, check login page in browser
  - This built-in views doesn't work as normal debugger-write views
  - By adding login and logout urlpatterns we can use these built-in forms
  - We need to change Django default login and logout template location inside the <span style="color: Red;">as_view()</span>
  - After creating login and logout html file inside the users app templates, we need to copy all codes inside the register template to these files
  - We should change the urls in the log in and registration page to actual pages
  - After loading the login page we need to redirect page, so check the log in before and then change it.
  - To redirect user to userProfile(we add it later) or Home page we should add <span style="color: Red;">LOGIN_REDIRECT_URL</span> to the django project <span style="color: Red;">settings.py</span> file
  - We need to redirect our user after registration to the login page, so we'll do it in <span style="color: Red;">user app view.py</span>
  - Check the logout page by removing <span style="color: Yellow;">template_name</span> from as_vie() method, before change it to correct form
  - We should create <span style="color: Red;">logout.html</span> file andd fill it with register.html content and change in context and urls
  - After Creating LogIn, LogOut, and Register pages we need to change in our <span style="color: Red;">navigation bar</span> urls
  - We need to define that if a user is log in, doesn't able to open login or register page
  - Django make it easy for us by providing us with a user variable that contain current user
  - It has an attribute called <span style="color: Red;">is_authenticated</span> and by using a <span style="color: Red;">if</span> statement for right navbar we can do it
  - Before ending the login/logout section we need to restricted some part or pages of site that user can visit without being log in <span style="color: Red;">(user profile page)</span>
  - We should create a view for profile page and its template inside user app templates (just a simple page that echo current user's username)
  - Then we should add profile page url to project urlpattern
  - We need to add profile page link to our navbar
  - Check profile page when user is log out
  - To restrict profile page we need to decorate our profile view by <span style="color: Red;"> login_required</span> decorator in users/views.py file (first need to import this decorator)
  - To redirect user to log in page when user want to access to the profile page without being login we need to add <span style="color: Red;"> LOGIN_URL = 'login'</span> to project settings
  - Check the url after restriction of accessoing to the profile page and explain Django keeping track of opening pages
- <span style="color: Red;">User Profile and Picture</span>
  - To add profile image to a user profile we need to extend user model that Django created by default
  - to extend a model in user app we need to create a new model and inherit all features from models in Django
  - Relation between user and profile is one-to-one relationship
  - create a class called <span style="color: Red;">Profile</span> inside <span style="color: Yellow;">users/models.py</span> and firstly we need to extend our user model
  - First we should make one-to-one relationship between User model and our Profile model and define <span style="color: Red;">CASCADE</span> variable for it
  - After making relationship we can define any additional field that we want
  - Explain <span style="color: Yellow;">default</span> and <span style="color: Yellow;">upload_to</span> variable
  - It's better to define dander str \_\_str method to make a desire display for our Profile Instances
  - After creating our model we need to migrate it to our database (Explain about initially Error)
  - To work with images inside python programs we need to install <span style="color: Red;">Pillow</span> library
  - First of all we should register this model within the admin file of our app
  - Now we can add a new profile manually within the admin page
  - Inside Django shell check that how can we access to these profile and images manually
  - First import User model then create a user instance. After that we have a one-to-one relationship and can access to the profile
  - Check image and its attributes and for default.jpg (user without image)
  - Talk about profile_pics directory and the cause of its name and why we need to change the directory <span style="color: Red;">(MEDIA_ROOT and MEDIA_URL)</span>
  - Delete the old profiles and profile_pics directory
  - Use code snippets to add some code to the profile template in user app and display the user profile picture
  - Check <span style="color: Orange;">Django managing static files documentation</span> and make some changes that the Django want, within the project urls.py
  - Check the user that has no profile image and set a default image for this purpose (copy the default image within the media directory)
  - To change our site to create a profile for each of our users automatically we need to create a signal
  - Add <span style="color: Green;">signals.py</span> file to our user app directory
  - Actually User is a signal sender and we need to define a function to receive the signal and perform some tasks <span style="color: #0088ff;">(import post_save, user, and receiver libraries)</span>
  - Explain the sender and receiver collaboration process simply
  - After the defining of sender and receiver we need to import our signals inside the <span style="color: Green;">ready</span> method within the app.py (user app)
- <span style="color: Red;">Update User Profile</span>
  - To update a user profile we need to some forms to get data and update it, so we need to create a model form that allows us to create a form that will work with a specific database model
  - To add profile model to our update form we need to import it inside the file
  - After creating <span style="color: #0088ff;">UserUpdateForm</span> and <span style="color: #0088ff;">ProfileUpdateForm</span> we need to import them inside our profile <span style="color: Orange">views.py</span> (user app) files
  - We should <span style="color: #0088ff;">Instantiated</span> our user and profile update form and send them as <span style="color: Red;">context</span> to profile template file
  - To use these forms inside template, it's better to use registration form code and after duplicate the <span style="color: Red;">{{form|crispy}}</span> part make it clear and appropriate
  - To make it work properly we should add <span style="color: Red;">enctype</span> to our form tag
  - To Show the current user data in the fields we need to send the to the page using the instance of them
  - Then we need to check the request (POST) and if the user push the submit bottom update the fields
  - After that we should save our forms if both are valid
  - And we can send a success alert message to the user like registration form
  - The profile Image Uploaded in actual size and we need to resize it automatically (Large images take a lot of space in server)
  - <span style="color: #0088ff;">Pillow</span> allows us to resize the image through the uploading process
  - We should update our <span style="color: Yellow;">user app model</span> <span style="color: Red;">(Save method should be overwrite in profile model)</span>
  - First we need to give all functionality of our parent save() method to our overwrote method by <span style="color: Orange;">super()</span>
  - After that we need to import <span style="color: #0088ff;">PIL(pillow)</span> to our file
  - Now we should open our uploaded image instance and resize it and save it in same path
  - We can add author image beside each post and to do that we should edit our <span style="color: Yellow;">blog app home</span> template
- <span style="color: Red;">Create Update and Delete Posts</span>
  - In our blog app to handel home and about page we used <span style="color: #0088ff;">function based views</span>
  - There is a different kind of views called <span style="color: Red;">class based views</span> (there ate different kinds of class views like list vies, detail views, create views, etc.)
  - We can convert our home function based view to a class view and see differences.(First import <span style="color: Yellow;">ListView</span>)
  - We should create our <span style="color: #0088ff;">PostListView</span> class and it inherits everything from ListView class
  - To tell our class that what model to query in order to create the list by creating an variable called <span style="color: Orange;">model</span>
  - Now we need to make some changes inside <span style="color: Yellow;">blog urls.py</span> file to handel our new class based view
  - First check the error in home page and tell about <span style="color: #0088ff;">certain naming pattern</span> for class based views
  - Explain <span style="color: Red;">'\<app>/\<model>\_\<viewtype>.html'</span>
  - To use our old template we should add a variable called <span style="color: #00ffff;">'template_name'</span> to our new view
  - Inside the template we need a object list (**posts**) so we should send it from view by defining a new variable called <span style="color: #00ffff;">context_object_name</span>
  - to change the order of the list objects in our view list we can use a variable called <span style="color: Orange;">ordering</span> (use '-' to descending order)
  - Based on class based views to <span style="color: Orange;">create a individual page for each post</span> we can use <span style="color: Red;">detail view</span>
  - After creating the <span style="color: Red;">PostDetailView</span> we should create a url pattern for it (import the view first)
  - In this case we need to add variable to our url to separate each post <span style="color: #00ffff;">(.../3/) by its ID</span> (for doing this we can add a variable to view class as well)
  - Now we need to create a template for our detail page based of **naming convention** (copy codes from home.html)
  - After removing loop and link to each post by changing the post to object we can add <span style="color: #00ffff;">post/number_of_post</span> to url and see the detail of a specific post
  - Then we can redirect user by clicking to the each post link to actual post detail page (check the hover)
  - To create a create post view we should import this class first and make a url pattern for it
  - Now we should create a template for our post create view (because of form we should copy all codes from <span style="color: Yellow;">register</span> template)
  - Try to add a new post and face to error and explain it
  - To solve th problem we should define a new function to add current user id to our new form instance (define <span style="color: Red;">form_valid()</span> method inside the create post view)
  - Explain new error and and check the home page to see the new post (<span style="color: Red;">redirect</span> user to detail page after creating a new post)
  - To tell the Django how to find the location of a specific post we need to make some changes in <span style="color: Red;">post model in blog app</span>
  - We should use <span style="color: Red;">reverse()</span> method to do that (explain differences of reverse and redirect methods)
  - To make a page unreachable for not registered users we use <span style="color: Green;">decorator</span> and to use this functionality in class based views we need the <span style="color: Red;">Login Mixin</span> (first import it in views.py)
  - To Update a post first we need to import the <span style="color: Red;">UpdateView</span> in our views.py (copy PostCreateView() codes)
  - Add new view to url pattern (copy detail path url) and import the new view here
  - By adding the url pattern Django do everything for us and we don't need to do anything more
  - New we need to restrict user for updating other users post and we can do it by another Mixin method called <span style="color: Red;">UserPassTestMixin</span>
  - To run our Mixin method we can define a method <span style="color: Yellow;">(test_func())</span> that check the current user and the post author to allow user to update the post (inside update view)
  - Try to update another user to show <span style="color: Red;">404 Forbidden</span> error
  - <span style="color: Orange;">Delete view</span> is very similar to <span style="color: Yellow;">Detail view</span>, so we copy it and we need all Mixin methods and test_func() for Delete view as well
  - After add new view to url pattern and make new url we need a form for delete confirmation (copy code from <span style="color: Orange;">post_form.html</span>)
  - To use the create new post ability we should add it to nav bar for each user
  - Now we need to add "**update**" and "**delete**" button to detail pages
- <span style="color: Red;">Pagination</span>
  - I
